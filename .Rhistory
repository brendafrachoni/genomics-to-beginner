setwd("~/GitHub/genomics-to-beginner")
# Load packages
library(ggplot2)
library(dplyr)
library(cowplot)
# Import the read-length distribution table
read_length_df <- read.csv("length.csv")
# Organize the imported read-length table
# You can replace the level arguments for your platform, species, or strains
read_length_df$platform <- as.factor(read_length_df$platform)
read_length_df$platform <- factor(read_length_df$platform,level = c("PacBio_CLR","PacBio_HiFi","ONT"))
# Calculate the average read-lengths for each platform
summary_df <- plyr::ddply(read_length_df, "platform", summarise, grp.mean=mean(length))
# Draw a read-length distribution plot for all reads
total.length.plot <- ggplot(read_length_df, aes(x=length, fill=platform, color=platform)) +
geom_histogram(binwidth=100, alpha=0.5, position="dodge") +
geom_vline(data=summary_df, aes(xintercept=grp.mean, color=platform), linetype="dashed", linewidth=0.2) +
scale_x_continuous(labels = comma) +
scale_y_continuous(labels = comma) +
labs(x = "Read length (bp)", y = "Count") +
theme_bw()
View(read_length_df)
# Draw a read-length distribution plot for all reads
total.length.plot <- ggplot(read_length_df, aes(x=length, fill=platform, color=platform)) +
geom_histogram(binwidth=100, alpha=0.5, position="dodge") +
geom_vline(data=summary_df, aes(xintercept=grp.mean, color=platform), linetype="dashed", linewidth=0.2) +
#scale_x_continuous(labels = comma) +
#scale_y_continuous(labels = comma) +
labs(x = "Read length (bp)", y = "Count") +
theme_bw()
total.length.plot
# Draw a read-length distribution plot for reads ≤ 20 kb in length
kb.length.plot <- ggplot(read_length_df, aes(x=length, fill=platform, color=platform)) +
geom_histogram(binwidth=50, alpha=0.5, position="dodge") +
geom_vline(data=summary_df, aes(xintercept=grp.mean, color=platform), linetype="dashed", size=0.2) +
scale_x_continuous(limit = c(0,20000)#, labels = comma
) +
scale_y_continuous(labels = comma) +
labs(x = "Read length (bp)", y = "Count") +
theme_bw()
# Draw a read-length distribution plot for reads ≤ 20 kb in length
kb.length.plot <- ggplot(read_length_df, aes(x=length, fill=platform, color=platform)) +
geom_histogram(binwidth=50, alpha=0.5, position="dodge") +
geom_vline(data=summary_df, aes(xintercept=grp.mean, color=platform), linetype="dashed", size=0.2) +
scale_x_continuous(limit = c(0,20000)#, labels = comma
) +
#scale_y_continuous(labels = comma) +
labs(x = "Read length (bp)", y = "Count") +
theme_bw()
kb.length.plot
# Merge both the read-length distribution plots
plot <- plot_grid(total.length.plot, kb.length.plot, ncol = 1)
plot
